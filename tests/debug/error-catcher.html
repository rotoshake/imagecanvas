<!DOCTYPE html>
<html>
<head>
    <title>Error Catcher</title>
    <script>
        // Catch all errors
        window.addEventListener('error', (event) => {
            console.error('Global error:', event.error);
            const log = document.getElementById('errorLog');
            if (log) {
                log.textContent += `ERROR: ${event.message}\nFile: ${event.filename}\nLine: ${event.lineno}\n\n`;
            }
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('Unhandled promise rejection:', event.reason);
            const log = document.getElementById('errorLog');
            if (log) {
                log.textContent += `PROMISE REJECTION: ${event.reason}\n\n`;
            }
        });
    </script>
</head>
<body>
    <h1>Loading main app with error catching...</h1>
    <h2>Errors:</h2>
    <pre id="errorLog" style="background: #fee; padding: 10px;"></pre>
    
    <h2>Network Layer Status:</h2>
    <pre id="status" style="background: #efe; padding: 10px;"></pre>
    
    <iframe src="/index.html" style="width: 100%; height: 500px; border: 1px solid #ccc;"></iframe>
    
    <script>
        // Check status periodically
        setInterval(() => {
            const iframe = document.querySelector('iframe');
            if (iframe && iframe.contentWindow) {
                const win = iframe.contentWindow;
                const status = document.getElementById('status');
                
                status.textContent = `
NetworkLayer class: ${typeof win.NetworkLayer !== 'undefined' ? '✅ Loaded' : '❌ Not loaded'}
OperationPipeline class: ${typeof win.OperationPipeline !== 'undefined' ? '✅ Loaded' : '❌ Not loaded'}
CollaborativeArchitecture class: ${typeof win.CollaborativeArchitecture !== 'undefined' ? '✅ Loaded' : '❌ Not loaded'}

window.app: ${win.app ? '✅ Exists' : '❌ Not found'}
${win.app ? `
app.networkLayer: ${win.app.networkLayer ? '✅ Exists' : '❌ Not found'}
app.operationPipeline: ${win.app.operationPipeline ? '✅ Exists' : '❌ Not found'}
app.collaborativeArchitecture: ${win.app.collaborativeArchitecture ? '✅ Exists' : '❌ Not found'}
` : ''}

${win.app && win.app.networkLayer ? `
NetworkLayer connected: ${win.app.networkLayer.isConnected ? '✅ Yes' : '❌ No'}
Current project: ${JSON.stringify(win.app.networkLayer.currentProject)}
` : ''}
                `;
            }
        }, 1000);
    </script>
</body>
</html>